import csv
import os
import operator
directory="/home/manasa/Documents/6thSem/projects/IAS/linux/IAS/extractvirus"
attributes=[]
for f in os.listdir(directory):
	path="/home/manasa/Documents/6thSem/projects/IAS/linux/IAS/extractvirus/"+f
	fread1=open(path,'r')
	if(f[0]=='d'):
		for line in fread1:
			if "(" in line:
				attributes.append(line.split("(")[0])
				#print attributes
			else:
				continue
	else:
		for line in fread1:
			#attributes.append(line.split(" ")[7].split("@")[0])
			a=line.split(" ")
			if "(" in a[-1]:
				print "Appending",a[len(a)-2].split("@")[0].replace("\n","")
				attributes.append(a[len(a)-2].split("@")[0].replace("\n",""))
			else:
				print "Appending",a[-1].split("@")[0].replace("\n","")
				attributes.append(a[-1].split("@")[0].replace("\n",""))
	fread1.close()
#print set(attributes)
print len(set(attributes))

final=set(attributes)
final=list(final)
for i in final:
	print i

d={}
for i in range(len(final)):
	command="grep -l '"+final[i]+"' -R /home/manasa/Documents/6thSem/projects/IAS/linux/IAS/extractvirus | wc -l"
	os.system(command + " > " + "results.txt")
	f=open("results.txt","r")
	for line in f:
		d[final[i]]=int(line)
	print d[final[i]]
	f.close()
	print "done loop",i
print d
sorted_final=sorted(d.items(), key=operator.itemgetter(1),reverse=True)
for k in range(500):
	print sorted_final[k]

f1=open("virusAttributes1.txt","a+")
for k in sorted_final:
	f1.write(str(k[0]+" "+str(k[1])))
	f1.write("\n")
f1.close()