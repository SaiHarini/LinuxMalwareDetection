import csv
import os
import pyexcel
directory="/home/manasa/Documents/6thSem/projects/IAS/linux/IAS/exp"


f=open("benignAttributes.txt","r")
csv_attr=[]
count=-1
for line in f:
	count=count+1
	if(count==500):
		break
	csv_attr.append(line.split(" ")[0])
print csv_attr
print len(set(csv_attr))
f.close()

f=open("virusAttributes.txt","r")
count=-1
for line in f:
	count=count+1
	if(count==500):
		break
	csv_attr.append(line.split(" ")[0])
#print csv_attr
print len(set(csv_attr))

csv_attr=list(set(csv_attr))
no_of_files=0
for f in os.listdir(directory):
	no_of_files=no_of_files+1
data=[]
data.append(csv_attr)
data[1:]=[0]*no_of_files
for i in xrange(1,len(data)):
	data[i]=[0]*(len(csv_attr)+1)
print "rows=",len(data)
print "cols=",len(data[0])
cl="benign"
'''for i in range(len(csv_attr)):
	no=0
	for f in os.listdir(directory):
		no=no+1
		if "virus" in f:
			cl="virus"
		else:
			cl="benign"
		fobj=open(f)
		text=fobj.read().strip().split()
		str1=''.join(text)
		if csv_attr in str1:
			data[no][i]=1
		if(i==0):
			data[no][len(csv_attr)]=cl'''
no=0
for f in os.listdir(directory):
	no=no+1
	if "virus" in f:
		cl="virus"
	else:
		cl="benign"
	path="/home/manasa/Documents/6thSem/projects/IAS/linux/IAS/exp/"+f
	fobj=open(path)
	text=fobj.read().strip().split()
	str1=''.join(text)
	for i in range(len(csv_attr)):
		if csv_attr[i] in str1:
			data[no][i]=1
	data[no][len(csv_attr)]=cl
	print "file done",(no+1)

data[0].append("class_label")
print data[0]

pyexcel.save_as(array = data, dest_file_name = 'csv_file_name.csv')


